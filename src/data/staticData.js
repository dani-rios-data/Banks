Starting data preprocessing...
Files found: bank-of-america-benchmark-v2.csv, capital-one-benchmark-v3.csv, pnc-bank-benchmark-v3.csv, td-bank-benchmark-v3.csv, wells-fargo-bank-benchmark-v3-1.csv

Processing data for Bank Of America...

First row structure:
{
  "Report Period": "01/01/2024 - 02/28/2025",
  "Day": "01/01/2024",
  "Week": "01/01/2024 - 01/07/2024",
  "Month": "January 2024",
  "Market": "NATIONAL",
  "Market Group": "NATIONAL",
  "Media Category": "Audio",
  "Media Type": "Local Radio",
  "Media Type Group": "Local Radio",
  "Brand": "BANK OF AMERICA BANK SVCS",
  "Brand Core": "BANK OF AMERICA",
  "Brand Extension": "BANK OF AMERICA",
  "Brand Variant": "BANK OF AMERICA BANK SVCS",
  "Subsidiary": "BANK OF AMERICA NA",
  "Major Category": "FINANCIAL",
  "Advertiser Domain": "",
  "Advertiser Search Category": "",
  "Delivery Platform": "",
  "Device": "",
  "Ad Placement Type": "",
  "Creative ID": "",
  "Display Type": "",
  "Landing Page URL": "",
  "Program Name": "",
  "Telecast Indicator": "",
  "Section": "",
  "Premium Position": "",
  "Distributor": "KATZ-AM",
  "Distributor Description": "",
  "Distributor Genre": "",
  "Dollars ": "$16"
}
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Processed 100000 rows...
Processed 200000 rows...
Processed 300000 rows...

Completed Bank Of America:
- Total rows: 862228
- Processed rows: 307717
- Errors: 554511
- Total investment: $286.25M

Distribution by media category:
- Television: $123.81M
- Digital: $115.35M
- Audio: $32.45M
- Print: $13.15M
- Outdoor: $1.49M

Processing data for Capital One...

First row structure:
{
  "Report Period": "01/01/2024 - 02/28/2025",
  "Day": "01/01/2024",
  "Week": "01/01/2024 - 01/07/2024",
  "Month": "January 2024",
  "Market": "NATIONAL",
  "Market Group": "NATIONAL",
  "Media Category": "Audio",
  "Media Type": "Local Radio",
  "Media Type Group": "Local Radio",
  "Brand": "CAPITAL ONE BANK SVCS",
  "Brand Core": "CAPITAL ONE",
  "Brand Extension": "CAPITAL ONE",
  "Brand Variant": "CAPITAL ONE BANK SVCS",
  "Subsidiary": "CAPITAL ONE BANK NA",
  "Major Category": "FINANCIAL",
  "Advertiser Domain": "",
  "Advertiser Search Category": "",
  "Delivery Platform": "",
  "Device": "",
  "Ad Placement Type": "",
  "Creative ID": "",
  "Display Type": "",
  "Landing Page URL": "",
  "Program Name": "",
  "Telecast Indicator": "",
  "Section": "",
  "Distributor": "KAAZ-FM",
  "Distributor Description": "",
  "Premium Position": "",
  "Dollars ": "$926"
}
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Processed 100000 rows...
Processed 200000 rows...
Processed 300000 rows...
Processed 400000 rows...
Processed 500000 rows...
Processed 600000 rows...
Processed 700000 rows...
Processed 800000 rows...
Processed 900000 rows...
Processed 1000000 rows...
Processed 1100000 rows...

Completed Capital One:
- Total rows: 2256525
- Processed rows: 1175013
- Errors: 1081512
- Total investment: $837.60M

Distribution by media category:
- Television: $425.03M
- Digital: $350.95M
- Audio: $35.62M
- Print: $15.78M
- Outdoor: $6.05M

Processing data for Pnc Bank...

First row structure:
{
  "Report Period": "01/01/2024 - 02/28/2025",
  "Day": "01/01/2024",
  "Week": "01/01/2024 - 01/07/2024",
  "Month": "January 2024",
  "Market": "NATIONAL",
  "Market Group": "NATIONAL",
  "Media Category": "Audio",
  "Media Type": "Local Radio",
  "Media Type Group": "Local Radio",
  "Brand": "PNC BANK BANK SVCS",
  "Brand Core": "PNC BANK",
  "Brand Extension": "PNC BANK",
  "Brand Variant": "PNC BANK BANK SVCS",
  "Subsidiary": "PNC BANK NA",
  "Major Category": "FINANCIAL",
  "Advertiser Domain": "",
  "Advertiser Search Category": "",
  "Delivery Platform": "",
  "Device": "",
  "Ad Placement Type": "",
  "Creative ID": "",
  "Display Type": "",
  "Landing Page URL": "",
  "Program Name": "",
  "Telecast Indicator": "",
  "Section": "",
  "Premium Position": "",
  "Distributor": "KBFF-FM",
  "Distributor Description": "",
  "Dollars ": "$30"
}
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0

Completed Pnc Bank:
- Total rows: 71043
- Processed rows: 69581
- Errors: 1462
- Total investment: $76.09M

Distribution by media category:
- Television: $67.38M
- Digital: $5.20M
- Outdoor: $1.56M
- Audio: $1.33M
- Print: $0.63M

Processing data for Td Bank...

First row structure:
{
  "Report Period": "01/01/2024 - 02/28/2025",
  "Day": "01/01/2024",
  "Week": "01/01/2024 - 01/07/2024",
  "Month": "January 2024",
  "Market": "NATIONAL",
  "Market Group": "NATIONAL",
  "Media Category": "Audio",
  "Media Type": "Local Radio",
  "Media Type Group": "Local Radio",
  "Brand": "TD BANK BANK SVCS",
  "Brand Core": "TD BANK",
  "Brand Extension": "TD BANK",
  "Brand Variant": "TD BANK BANK SVCS",
  "Subsidiary": "TD BANK NA",
  "Major Category": "FINANCIAL",
  "Advertiser Domain": "",
  "Advertiser Search Category": "",
  "Delivery Platform": "",
  "Device": "",
  "Ad Placement Type": "",
  "Creative ID": "",
  "Display Type": "",
  "Landing Page URL": "",
  "Program Name": "",
  "Telecast Indicator": "",
  "Section": "",
  "Premium Position": "",
  "Distributor Description": "",
  "Distributor": "WBZ-FM",
  "Dollars ": "$2058"
}
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Processed 100000 rows...

Completed Td Bank:
- Total rows: 232118
- Processed rows: 145351
- Errors: 86767
- Total investment: $38.32M

Distribution by media category:
- Digital: $20.44M
- Television: $16.41M
- Outdoor: $1.42M
- Audio: $0.04M
- Print: $0.01M

Processing data for Wells Fargo Bank...

First row structure:
{
  "Report Period": "01/01/2024 - 02/28/2025",
  "Day": "01/01/2024",
  "Week": "01/01/2024 - 01/07/2024",
  "Month": "January 2024",
  "Market": "NATIONAL",
  "Market Group": "NATIONAL",
  "Media Category": "Audio",
  "Media Type": "Local Radio",
  "Media Type Group": "Local Radio",
  "Brand": "WELLS FARGO BANK SVCS",
  "Brand Core": "WELLS FARGO",
  "Brand Extension": "WELLS FARGO",
  "Brand Variant": "WELLS FARGO BANK SVCS",
  "Subsidiary": "WELLS FARGO BANK NA",
  "Major Category": "FINANCIAL",
  "Advertiser Domain": "",
  "Advertiser Search Category": "",
  "Delivery Platform": "",
  "Device": "",
  "Ad Placement Type": "",
  "Creative ID": "",
  "Display Type": "",
  "Landing Page URL": "",
  "Program Name": "",
  "Telecast Indicator": "",
  "Section": "",
  "Premium Position": "",
  "Distributor": "KABC-AM",
  "Distributor Description": "",
  "Dollars ": "$426"
}
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Investment error: undefined -> 0
Processed 100000 rows...
Processed 200000 rows...
Processed 300000 rows...
Processed 400000 rows...

Completed Wells Fargo Bank:
- Total rows: 764202
- Processed rows: 469212
- Errors: 294990
- Total investment: $196.28M

Distribution by media category:
- Television: $132.54M
- Digital: $49.64M
- Audio: $11.85M
- Outdoor: $1.60M
- Print: $0.65M

Saving processed data...
Preprocessing completed successfully.
Data saved to C:\Users\dany2\Downloads\banking-ad-dashboard\public\processed\dashboard-data.json

Final statistics:
- Number of banks processed: 5
- Number of months with data: 15
- Number of media categories: 7
- Total investment: $1434.55M

Top 5 media categories by investment:
- Television: $765.17M
- Digital: $541.58M
- Audio: $81.30M
- Print: $30.21M
- Outdoor: $12.11M

Banks sorted by total investment:
- Capital One: $837.60M
- Bank Of America: $286.25M
- Wells Fargo Bank: $196.28M
- Pnc Bank: $76.09M
- Td Bank: $38.32M
